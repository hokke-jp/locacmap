document.getElementById('search-conditions').innerHTML = `<%= render 'microposts/search_conditions' %>`
document.getElementById('microposts').innerHTML = `<%= render 'shared/microposts', microposts: @microposts %>`
document.getElementById('link-to-map').innerHTML = `<%= link_to "検索結果を地図で見る", map_path(microposts_ids: @microposts_ids), class: "btn-blue inline-block" %>`

// 検索後、@miropostsを更新させる(しないと、並び替えをすると前の検索結果で並び替えられる)
document.getElementById('latest').checked = true;
document.getElementById('latest-label').innerHTML = `<%= link_to "最新", sort_latest_path(microposts_ids: @microposts_ids), {remote: true, class: "block p-3"} %>`
document.getElementById('going-label').innerHTML = `<%= link_to "行ってみたい!", sort_going_path(microposts_ids: @microposts_ids), {remote: true, class: "block p-3"} %>`
document.getElementById('period-asc-label').innerHTML = `<%= link_to "時代昇順", sort_period_asc_path(microposts_ids: @microposts_ids), {remote: true, class: "block p-3"} %>`
document.getElementById('period-desc-label').innerHTML = `<%= link_to "時代降順", sort_period_desc_path(microposts_ids: @microposts_ids), {remote: true, class: "block p-3"} %>`

function modal() {
  let triggers = document.getElementsByClassName('grad-trigger');
  let body = document.getElementsByTagName('body');
  for (let i = 0; i < triggers.length; i++){
    triggers[i].addEventListener('click', () => {
      if (triggers[i].checked) {
      let posi = window.pageYOffset;
      body[0].style.position = 'fixed';
      body[0].style.top = `${-1 * posi}` + "px";
      triggers[i].dataset.num = posi;
  
      // iframe読み込みをクリック時のみに設定
      let iframe = triggers[i].nextElementSibling.nextElementSibling.getElementsByTagName('iframe');
      if (iframe[0].src === "about:blank") {
        iframe[0].setAttribute("src", iframe[0].dataset.src);
      }
    } else {
      body[0].style.position = 'static';
      let position = triggers[i].dataset.num;
      scrollTo(0, position);
    }
    });
  }
}
modal();
